{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport PlaceItem from \"./PlaceItem\";\nimport { SelectMarkerContext } from \"../../Context/SelectMarkerContext\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { app } from \"../../Utils/FirebaseConfig\";\nimport { collection, query, where, getDocs } from \"firebase/firestore\";\nimport { useUser } from '@clerk/clerk-expo';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function PlaceListView(_ref) {\n  var placeList = _ref.placeList;\n  var flatListRef = useRef(null);\n  var _useUser = useUser(),\n    user = _useUser.user;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    favList = _useState2[0],\n    setFavList = _useState2[1];\n  var _useContext = useContext(SelectMarkerContext),\n    selectedMarker = _useContext.selectedMarker,\n    setSelectedMarker = _useContext.setSelectedMarker;\n  useEffect(function () {\n    selectedMarker && scrollToIndex(selectedMarker);\n  }, [selectedMarker]);\n  var scrollToIndex = function scrollToIndex(index) {\n    var _flatListRef$current;\n    (_flatListRef$current = flatListRef.current) == null ? void 0 : _flatListRef$current.scrollToIndex({\n      animated: true,\n      index: index\n    });\n  };\n  var getItemLayout = function getItemLayout(_, index) {\n    return {\n      length: Dimensions.get('window').width,\n      offset: Dimensions.get('window').width * index,\n      index: index\n    };\n  };\n  var db = getFirestore(app);\n  useEffect(function () {\n    user && getFav();\n  }, [user]);\n  var getFav = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var _user$primaryEmailAdd;\n      setFavList([]);\n      var q = query(collection(db, \"ev-fav-place\"), where(\"email\", \"==\", user == null ? void 0 : (_user$primaryEmailAdd = user.primaryEmailAddress) == null ? void 0 : _user$primaryEmailAdd.emailAddress));\n      var querySnapshot = yield getDocs(q);\n      querySnapshot.forEach(function (doc) {\n        console.log(doc.id, \" => \", doc.data());\n        setFavList(function (favList) {\n          return [].concat(_toConsumableArray(favList), [doc.data()]);\n        });\n      });\n    });\n    return function getFav() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var isFav = function isFav(place) {\n    var result = favList.find(function (item) {\n      return item.place.id == place.id;\n    });\n    console.log(result ? true : false);\n    return result ? true : false;\n  };\n  return _jsx(View, {\n    children: _jsx(FlatList, {\n      data: placeList,\n      horizontal: true,\n      pagingEnabled: true,\n      ref: flatListRef,\n      getItemLayout: getItemLayout,\n      showsHorizontalScrollIndicator: false,\n      renderItem: function renderItem(_ref3) {\n        var item = _ref3.item,\n          index = _ref3.index;\n        return _jsx(View, {\n          children: _jsx(PlaceItem, {\n            place: item,\n            isFav: isFav(item),\n            markedFav: function markedFav() {\n              return getFav();\n            }\n          })\n        }, index);\n      }\n    })\n  });\n}","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","PlaceItem","SelectMarkerContext","getFirestore","app","collection","query","where","getDocs","useUser","jsx","_jsx","PlaceListView","_ref","placeList","flatListRef","_useUser","user","_useState","_useState2","_slicedToArray","favList","setFavList","_useContext","selectedMarker","setSelectedMarker","scrollToIndex","index","_flatListRef$current","current","animated","getItemLayout","_","length","Dimensions","get","width","offset","db","getFav","_ref2","_asyncToGenerator","_user$primaryEmailAdd","q","primaryEmailAddress","emailAddress","querySnapshot","forEach","doc","console","log","id","data","concat","_toConsumableArray","apply","arguments","isFav","place","result","find","item","View","children","FlatList","horizontal","pagingEnabled","ref","showsHorizontalScrollIndicator","renderItem","_ref3","markedFav"],"sources":["C:/Users/vivek/Downloads/final_yr_project/222957_EVChargingAppmain/EV-Charging-App-main/App/Screen/HomeScreen/PlaceListView.jsx"],"sourcesContent":["import { View, Text, FlatList, Dimensions } from 'react-native'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport PlaceItem from './PlaceItem';\nimport { SelectMarkerContext } from '../../Context/SelectMarkerContext';\nimport { getFirestore } from \"firebase/firestore\";\nimport { app } from '../../Utils/FirebaseConfig';\nimport { collection, query, where, getDocs } from \"firebase/firestore\";\nimport { useUser } from '@clerk/clerk-expo';\nexport default function PlaceListView({placeList}) {\n  const flatListRef = useRef(null);\n \n  const {user}=useUser();\n  const [favList,setFavList]=useState([]);\n  const {selectedMarker,setSelectedMarker}=useContext(SelectMarkerContext);\n  useEffect(()=>{\n     selectedMarker&&scrollToIndex(selectedMarker)\n  },[selectedMarker]) \n\n\n  const scrollToIndex=(index)=>{\n    flatListRef.current?.scrollToIndex({animated:true,index})\n  }\n  const getItemLayout=(_,index)=>({\n    length:Dimensions.get('window').width,\n    offset:Dimensions.get('window').width*index,\n    index\n  });\n\n  // Get Data from Firestore \n  const db = getFirestore(app);\n  useEffect(()=>{\n    user&&getFav();   \n  },[user])\n \n  const getFav=async()=>{\n    setFavList([])\n    const q = query(collection(db, \"ev-fav-place\"), \n    where(\"email\", \"==\", user?.primaryEmailAddress?.emailAddress));\n\n    const querySnapshot = await getDocs(q);\n    querySnapshot.forEach((doc) => {\n      // doc.data() is never undefined for query doc snapshots\n     console.log(doc.id, \" => \", doc.data()); \n      setFavList(favList=>[...favList,doc.data()]);\n    });\n  }\n\n  const isFav=(place)=>{\n    const result=favList.find(item=>item.place.id==place.id);\n    //result&&console.log(result)\n    console.log(result?true:false)\n    return result?true:false;  \n  }\n\n\n \n  return (\n    <View>\n      <FlatList\n        data={placeList} \n        horizontal={true}\n        pagingEnabled\n        ref={flatListRef}\n        getItemLayout={getItemLayout}\n        showsHorizontalScrollIndicator={false}\n        renderItem={({item,index})=>( \n            <View key={index} >\n                <PlaceItem place={item}\n                  isFav={isFav(item)}\n                  markedFav={()=>getFav()} \n                 />\n            </View>\n        )}\n      />\n    </View>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}